#!/bin/sh

OLD_SYSPROXY="/Library/PrivilegedHelperTools/routex.helper"

UNINSTALL=false

if [ ! -f "$OLD_SYSPROXY" ]; then
    UNINSTALL=true
fi

if [ "$UNINSTALL" = true ]; then
    if launchctl list | grep -q "routex.helper"; then
        launchctl stop routex.helper 2>/dev/null || true
        launchctl unload /Library/LaunchDaemons/routex.helper.plist 2>/dev/null || true
    fi

    for file in "/Library/LaunchDaemons/routex.helper.plist" \
               "/Library/PrivilegedHelperTools/routex.helper" \
               "/tmp/routex.helper" \
               "/tmp/routex-helper.sock"; do
        if [ -e "$file" ]; then
            rm -f "$file"
        fi
    done
fi

exit 0
